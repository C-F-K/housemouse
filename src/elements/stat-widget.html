<link rel="import" href="stat-bar.html">
<link rel="import" href="../vendor/core-tooltip/core-tooltip.html">

<polymer-element name="stat-widget" attributes="vote">

  <template>
    <template repeat="{{ chosenConcepts in dataForStatBar }}">
      <stat-bar concept="{{ chosenConcepts }}"></stat-bar>
    </template>
  </template>

  <script>    
    Polymer('stat-widget', {     
      concepts: [
        {  
          name: "security",
          total: 13,
          working: 5,
          notWorking: 6,
          semiWorking: 2
        },
        {
          name: "wealth",
          total: 15,
          working: 6,
          notWorking: 6,
          semiWorking: 3
        },
        {
          name: "transport",
          total: 20,
          working: 8,
          notWorking: 7,
          semiWorking: 5
        },
        {
          name: "health",
          total: 15,
          working: 8,
          notWorking: 2,
          semiWorking: 5
        },
        {
          name: "nature",
          total: 20,
          working: 8,
          notWorking: 7,
          semiWorking: 5
        },
        {
          name: "family",
          total: 20,
          working: 8,
          notWorking: 7,
          semiWorking: 5
        }
      ],
      vote: {
        id: 1,
        houseType: "flat",
        concepts: ["security", "wealth", "health"]
      },
      voteChanged: function(){
        this.updateStats();
        console.log(this.vote);
      },
      updateStats: function(){
        var dataForStatBarTemp = [];
        var choices = this.vote.concepts;
        this.choices = this.vote.concepts;
        for(var object in this.concepts) {
          var name = this.concepts[object].name;
          for(var i = 0; i < choices.length; i++) {
            if(name === choices[i]) {
              dataForStatBarTemp[i] = this.concepts[object];
            }
          }
        }
        this.dataForStatBar = dataForStatBarTemp;
      },
      ready: function(){
        this.updateStats();
      }       
    });
  </script>
</polymer-element>
